<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>{{title}}</title>

    <!-- Bootstrap Core CSS -->
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">

    <!-- Theme CSS -->
    <link href="../static/css/freelancer.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../static/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


    <!-- Navigation -->
    <nav id="mainNav" class="navbar navbar-default navbar-fixed-top navbar-custom">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span> Menu <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand" href="#maincontent">Code Coach</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li class="page-scroll dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Analysis<b class="caret"></b></a>
                        <ul class="dropdown-menu" style="background-color: #3498DB; border-color:#3498DB;">
                          <li><a href="#overview">Overview</a></li>
                          <li><a href="#tags">Problem tags</a></li>
                          <li><a href="#pvsc">Contest vs. practice</a></li>
                          <li><a href="#comp">Similar users</a></li>
                        </ul>
                    </li>



                    <li class="page-scroll">
                        <a href="#suggestions">Reccomendations</a>
                    </li>
                    <li class="page-scroll">
                        <a href="#query">Search</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>


    <!-- Header -->
    <header>
        <div class="container" id="maincontent" tabindex="-1">
            <div class="row" style="padding-top: -5cm;">
                <div class="col-lg-12">
                  <p><br><p>
                    <div class="intro-text">
                      <h1>{{handle}}</h1>
                      <span class="skills">Predicted next rating change: {{delta}}</span>

                      <div class="col-lg-12">
                        <hr class="star-light">
                        <br> You solved {{user_stats['nproblems30']}} problems in the last 30 days.
                        <br> You've solved {{user_stats['nproblems']}} problems overall.
                      </div>
                    </div>
                </div>
            </div>
        </div>
    </header>



  <!------------------------------------------------ ACTITIVY ------------------------------------------------>
    <section id="overview">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h3>Contest and practice</h3>
                </div>

                <div class="col-lg-10 col-lg-offset-1">
                <p> Hover each dot to see contest information.
                Blue dots indicate individual contest ratings. Red dots indicate problem ratings.
                Black line shows smoothed user rating.
                Size of red dots indicate the difficulty of solving
                this problem in contest given your smoothed rating at that time.
                </div>

                <div class="col-sm-12", style="min-height=500px; overflow: hidden; display:block;">
                    <div class="chart-wrapper">
                        <div id="{{ids[0]}}"></div>
                    </div>
                </div>

                <!--
                <div class="col-lg-12 text-center">
                  <a href="#maincontent"><div class="dropup"><span class="caret" style="border-width: 12px"></span></div></a>
                </div>
                -->
            </div>
          </div>
        </div>
    </section>

  <!------------------------------------------------ TAGS ------------------------------------------------>
    <section id="tags">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h3>Number of problems solved by type</h3>
                </div>
                <div class="col-lg-10 col-lg-offset-1">
                <p> The chart below displays the number of problems you've solved grouped by problem tags.
                <br> Note that problem tags are provided by contest problem writers, and may not necessarily
                reflect the "true" problem type. For example, dynamic programming on trees are frequently
                categorized as "dfs and similar".
                </div>


                <div class="col-lg-8 col-lg-offset-1", style="min-height=500px; overflow: hidden; display:block;">
                    <div class="chart-wrapper">
                      <div id="{{ids[3]}}"></div>
                    </div>
                </div>
            </div>

          </div>
        </div>
    </section>

  <!---------------------------------------- PROBLEM DIFFICULTY IN CONTEST VS PRACTICE-------------------------------------------->
    <section id="pvsc">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h3>Distribution of problem difficulties in contest vs. practice</h3>
                </div>
                <div class="col-lg-10 col-lg-offset-1">
                <p> Users typically solve problems of different difficulties during practice, when pressure is low, than during contests.
                The chart below shows the distribution of problem
                difficulties you have solved during contest vs. practice.
                Violet: contest. Yellow: practice.
                </div>


                <div class="col-lg-8 col-lg-offset-2", style="min-height=600px; overflow: hidden; display:block;">
                    <div id="{{ids[4]}}" style="height=100%"></div>
                </div>
            </div>

          </div>
        </div>
    </section>

  <!---------------------------------------- OTHER STATS -------------------------------------------->
    <section id="comp">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h3>Number of problems and contests compared with similar users</h3>
                </div>
                <div class="col-lg-10 col-lg-offset-1">
                <p> The plots below show the number of problems solved by users within 100 points of you. Your position is
                indicated by the black dot.
                The total number of solved problems is shown on the left. The total number of contests is shown on the right.
                Red: all users. Blue: users who eventually gained 100+ rating.
                </div>


                <div class="col-lg-4 col-lg-offset-2", style="min-height=600px; overflow: hidden; display:block;">
                  <div id="{{ids[1]}}"></div>
                </div>
                <div class="col-lg-4", style="min-height=600px; overflow: hidden; display:block;">
                  <div id="{{ids[2]}}"></div>
                </div>
            </div>

          </div>
        </div>
    </section>

      </div>
    </div>
	</div>

</div>


  <!------------------------------------------------ SUGGESTIONS ------------------------------------------------>
    <section class="success" id="suggestions" style="background-color: #2C3E50;">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                  <center>
                    <img class="img-responsive" src="../static/img/logo_img.png" alt="" width="10%">
                    <p>
                  </center>
                    <h2>Code Coach Suggestions</h2>
                    <hr class="star-light">
                </div>

                <div class="col-lg-10 col-lg-offset-1">

                  <p>According to model predictions, your should focus on problems 
                  <button type="button" class="btn btn-static btn-primary btn-lg nohover" style="background-color: #3498DB; color:#fff">
                    {{best_diff_str}}
                  </button>

                  <p>For you, some problem types are associated with higher rating increases, while some are associated with lower
                  rating increases. Code Coach suggests that you focus on the blue tags below during practice.</p>

                  <h4>Problem types to focus on</h4>
                  {% for tag in good_tags %}
                  <button type="button" class="btn btn-static btn-primary btn-s nohover" style="background-color: #3498DB; color:#fff">{{ tag[0] }}</button>
                  {% endfor %}

                  <p><br></p>
                  <h4>Problem types to avoid</h4>
                  {% for tag in bad_tags %}
                  <button type="button" class="btn btn-static btn-s nohover", style="background-color: #E74C3C; color:#fff">{{ tag[0] }}</button>
                  {% endfor %}

                  <p><br></p>

                <hr class="star-light">
                <p>Below are problems suggested based on your current rating and problem solving patterns.
                </div>

        <div class="row">
          <div class="col-sm-10 col-lg-offset-1">
              <div class="panel panel-primary filterable", style="border:0; background-color: #2C3E50; color=#fff;">
                  <table id="problem_table", class="table", style="width: 100%;
                    height=300px; max-height:300px; overflow-y: scroll;
                    display:block; background-color: #2C3E50; color=#fff">
                      <thead>
                          <tr class="filters">
                              <th>
                                  <select class="form-control">
                                    <option>Filter by tag</option>
                                    <option></option>
                                  {% for tag in unique_tags %}
                                    <option>{{ tag }}</option>
                                  {% endfor %}
                                  </select>
                              </th>
                              <th>Problem Difficulty<b class="caret"></b></th>
                              <th>Problem<b class="caret"></b></th>
                              <th>Contest<b class="caret"></b></th>
                              <th>Division<b class="caret"></b></th>
                          </tr>
                      </thead>
                      <tbody>
                        {% for problem in problems  %}
                        <tr>
                          <td>{{ problem['tag'] }}</td>
                          <td>{{ problem['problemrating'] }}</td>
                          <td>
                            <a href=http://codeforces.com/contest/{{problem['contestid']}}/problem/{{problem['problemid']}}><font color="#fff">{{ problem['name'] }}</font></a> 
                          </td>
                          <td>{{ problem['contestname'] }}</td>
                          <td>{{ problem['division'] }}</td>
                        </tr>
                        {% endfor %}
                      </tbody>
                  </table>
              </div>
          </div>
        </div>
      </div>
    </section>


  <!------------------------------------------------ QUERY ------------------------------------------------>
  <section class="success" id="query">
    <div class = "container">
    <div class="col-lg-12 text-center">
        <h3>Try another handle</h3>
        <hr class="star-light">
    </div>
    <div class="col-lg-8 col-lg-offset-2">
          <form  action="/output" method="GET">
            <div class="form-group">
              <label for="handle"><p>Codeforces handle:</label>
              <input type="text" id="handle" name='handle' placeholder="Limak the bear">  &nbsp; &nbsp; 
              <button type="submit" class="btn btn-lg btn-primary">Predict my score</button>
            </div>
          </form>

          <form  action="/output" method="GET">
            <div class="form-group text-center">
              <p style="padding-top = 0px"> -or-
              <p><input type="submit" name="submit" value="view a random handle" class="btn btn-lg btn-primary">
            </div>
          </form>
      </div>
    </div>
  </section>



















  </div>

  <script type="text/javascript" src="../static/lib/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript" src="../static/lib/bootstrap/dist/js/bootstrap.min.js"></script>

  <script type="text/javascript" src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>

  <script type="text/javascript" src="../static/lib/holderjs/holder.js"></script>
  <script>
    Holder.add_theme("white", { background:"#fff", foreground:"#a7a7a7", size:10 });
  </script>

  <script type="text/javascript" src="../static/lib/keen-js/dist/keen.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<script type="text/javascript">
(function() {

  var graphs = {{graphJSON | safe}};
  var ids = {{ids | safe}};
  var defaultPlotlyConfiguration = { modeBarButtonsToRemove: ['sendDataToCloud', 'autoScale2d', 'hoverClosestCartesian',
    'hoverCompareCartesian', 'lasso2d', 'select2d'],
    displaylogo: false, showTips: true, showLink: false };


  var d3 = Plotly.d3;

  var WIDTH_IN_PERCENT_OF_PARENT = 100,
      HEIGHT_IN_PERCENT_OF_PARENT = 70;

  // ---------------------------------------------------------
  // USER ACTIVITY
  graphs[0].layout['legend']['orientation'] = 'h';
  var gd0 = d3.select('#{{ids[0]}}')
      .append('div')
      .style({
          width: '100%',
          'margin-left': '0%',

          height: '65vh',
          'margin-top': 0
      });

  var node0 = gd0.node();
	Plotly.plot(node0, graphs[0].data, graphs[0].layout, defaultPlotlyConfiguration || {defaultPlotlyConfiguration});

  // ---------------------------------------------------------
  // TAGS
  var gd3 = d3.select('#{{ids[3]}}')
      .append('div')
      .style({
          width: '100%',
          'margin-left': 0 + '%',

          height: 70 + 'vh',
          'margin-top': 0 + '%'
      });

  var node3 = gd3.node();
	Plotly.plot(node3, graphs[3].data, graphs[3].layout, defaultPlotlyConfiguration || {defaultPlotlyConfiguration});

  // ---------------------------------------------------------
  // contest stats
  var gd1 = d3.select('#{{ids[1]}}')
      .append('div')
      .style({
          width: 100 + '%',
          'margin-left': 0 + '%',

          height: 40 + 'vh',
          'margin-top': 0 + '%'
      });

  var node1 = gd1.node();
	Plotly.plot(node1, graphs[1].data, graphs[1].layout, defaultPlotlyConfiguration || {defaultPlotlyConfiguration});

  // ---------------------------------------------------------
  // problem stats
  var gd2 = d3.select('#{{ids[2]}}')
      .append('div')
      .style({
          width: 100 + '%',
          'margin-left': 0 + '%',

          height: 40 + 'vh',
          'margin-top': 0 + '%'
      });

  var node2 = gd2.node();
	Plotly.plot(node2, graphs[2].data, graphs[2].layout, defaultPlotlyConfiguration || {defaultPlotlyConfiguration});

  // ---------------------------------------------------------
  // problem difficulty
  var gd4 = d3.select('#{{ids[4]}}')
      .append('div')
      .style({
          width: 100 + '%',
          'margin-left': 0 + '%',

          height: 40 + 'vh',
          'margin-top': 0 + '%'
      });

  var node4 = gd4.node();
	Plotly.plot(node4, graphs[4].data, graphs[4].layout, defaultPlotlyConfiguration || {defaultPlotlyConfiguration});


	window.onresize = function() {
			Plotly.Plots.resize(node0);
			Plotly.Plots.resize(node1);
			Plotly.Plots.resize(node2);
			Plotly.Plots.resize(node3);
			Plotly.Plots.resize(node4);
	};


})();

$(document).ready(function(){
    $('.filterable .btn-filter').click(function(){
        var $panel = $(this).parents('.filterable'),
        $filters = $panel.find('.filters input, .filters select'),
        $tbody = $panel.find('.table tbody');
        if ($filters.prop('disabled') == true) {
            $filters.prop('disabled', false);
            $filters.first().focus();
        } else {
            $filters.val('').prop('disabled', true);
            $tbody.find('.no-result').remove();
            $tbody.find('tr').show();
        }
    });

    $('.filterable .filters input').keyup(function(e){
        /* Ignore tab key */
        var code = e.keyCode || e.which;
        if (code == '9') return;
        /* Useful DOM data and selectors */
        var $input = $(this),
        inputContent = $input.val().toLowerCase(),
        $panel = $input.parents('.filterable'),
        column = $panel.find('.filters th').index($input.parents('th')),
        $table = $panel.find('.table'),
        $rows = $table.find('tbody tr');
        /* Dirtiest filter function ever ;) */
        var $filteredRows = $rows.filter(function(){
            var value = $(this).find('td').eq(column).text().toLowerCase();
            return value.indexOf(inputContent) === -1;
        });
        /* Clean previous no-result if exist */
        $table.find('tbody .no-result').remove();
        /* Show all rows, hide filtered ones (never do that outside of a demo ! xD) */
        $rows.show();
        $filteredRows.hide();
        /* Prepend no-result row if all rows are filtered */
        if ($filteredRows.length === $rows.length) {
            $table.find('tbody').prepend($('<tr class="no-result text-center"><td colspan="'+ $table.find('.filters th').length +'">No result found</td></tr>'));
        }
    });
    
    $('.filterable .filters select').change(function(e){
        /* Ignore tab key */
        /* Useful DOM data and selectors */
        var $input = $(this),
        inputContent = $input.val(),
        $panel = $input.parents('.filterable'),
        column = $panel.find('.filters th').index($input.parents('th')),
        $table = $panel.find('.table'),
        $rows = $table.find('tbody tr');
        /* Dirtiest filter function ever ;) */
        var $filteredRows = $rows.filter(function(){
            var value = $(this).find('td').eq(column).text().toLowerCase();
            return value.indexOf(inputContent) === -1;
        });
        /* Clean previous no-result if exist */
        $table.find('tbody .no-result').remove();
        /* Show all rows, hide filtered ones (never do that outside of a demo ! xD) */
        $rows.show();
        $filteredRows.hide();
        /* Prepend no-result row if all rows are filtered */
        if ($filteredRows.length === $rows.length) {
            $table.find('tbody').prepend($('<tr class="no-result text-center"><td colspan="'+ $table.find('.filters th').length +'">No result found</td></tr>'));
        }
    });    
    
});

</script>

<script>
$(document).ready(function() {
	$('#problem_table').DataTable( {
		"paging":   false,
		"ordering": true,
		"order": [[ 1, "desc" ]],
	} );
} );

</script>

<script>
  $('ul.nav li.dropdown').hover(function() {
    $(this).find('.dropdown-menu').stop(true, true).delay(0).fadeIn(100);
  }, function() {
    $(this).find('.dropdown-menu').stop(true, true).delay(0).fadeOut(100);
  });
</script>
  <!--  <script type="text/javascript" src="../static/js/meta.js"></script> -->
</body>
</html>

